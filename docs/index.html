<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How lrpackage works • lrpackage</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="How lrpackage works">
<meta property="og:description" content="The lrpackage is a comprehensive R package tailored for logistic regression analysis, encompassing a variety of functions that facilitate data preprocessing, model fitting, evaluation, and visualization.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">lrpackage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="how-lrpackage-works">
<strong>How lrpackage works</strong><a class="anchor" aria-label="anchor" href="#how-lrpackage-works"></a>
</h1></div>
<p><strong>Authors</strong>: Yingshan Qiu, Shakiru Oluwasanjo Oyeniran, Sk Nafiz Rahaman</p>
<p><strong>To open the help document, please write <code><a href="reference/beta_ls.html">?beta_ls</a></code> in the consol</strong></p>
<div class="section level2">
<h2 id="defining-the-package">Defining the package<a class="anchor" aria-label="anchor" href="#defining-the-package"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lrpackage</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-pre-processing">Data Pre-Processing<a class="anchor" aria-label="anchor" href="#data-pre-processing"></a>
</h2>
<p><strong>Reading and Initial Display:</strong> The package begins by reading a dataset (such as “expenses.csv”) and displaying its initial few rows. This dataset includes personal information such as age, sex, BMI, number of children, residential area, and medical costs, alongside smoking status.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"expenses.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">##   age    sex    bmi children smoker    region   charges</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  19 female 27.900        0    yes southwest 16884.924</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  18   male 33.770        1     no southeast  1725.552</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  28   male 33.000        3     no southeast  4449.462</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  33   male 22.705        0     no northwest 21984.471</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 5  32   male 28.880        0     no northwest  3866.855</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 6  31 female 25.740        0     no southeast  3756.622</span></span></code></pre></div>
<p><strong>Data Transformation:</strong> The data is then transformed into a numeric matrix, essential for subsequent analysis. This involves converting categorical variables (like sex and region) into binary numeric formats. The transformed data is then structured into predictor matrix X and response vector y.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"expenses.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"male"</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">smoker</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">smoker</span><span class="op">==</span><span class="st">"yes"</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">regionnortheast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"northeast"</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">regionnorthwest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"northwest"</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">regionsoutheast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"southeast"</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="va">x</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="logistic-regression">Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h2>
<p>The formula of losgistic regression based on response variable y and predictor variables <span class="math inline"><em>X</em><sub>1</sub></span>, <span class="math inline"><em>X</em><sub>2</sub></span>, … <span class="math inline"><em>X</em><sub><em>k</em></sub></span> is</p>
<p><span class="math display">$$
\hat{y} = \frac{1}{1+e^{-(\beta_0+\beta_1x_1+\cdots+\beta_kx_k)}}=\frac{1}{1+e^{-x^T\beta}}
$$</span> The best estimator of the coefficient vector <span class="math inline"><em>β</em></span> is computed with the least value of loss function of logistic regression, and the numerical optimization process is shown in the following:</p>
<p><span class="math display">$$
\hat{\beta}=\mathop{\arg\min}\limits_{\beta}\sum_{i=1}^n (-y_i\cdot \text{ln}(p_i)-(1-y_i)\cdot \text{ln}(1-p_i))
$$</span> where <span class="math display">$$
pi=\frac{1}{1+\text{exp}(-x_i^T\beta)},
$$</span> and <span class="math inline"><em>y</em><sub><em>i</em></sub></span> and <span class="math inline"><em>x</em><sub><em>i</em></sub></span> represent the ith observation and row of the response and the predictors respectively.</p>
<div class="section level4">
<h4 id="initial-values-for-optimization">Initial values for optimization<a class="anchor" aria-label="anchor" href="#initial-values-for-optimization"></a>
</h4>
<p>In order to start an optimization process, the package defines a initial value of coefficient matrix. In order to get the estimator more accurately, the package uses the least-square estimator as the initial matrix of coefficient.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">X</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">y</span></span></code></pre></div>
<p>Then, the package constructs a function of loss value. The function name would be <code>loss_func_lr</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loss_func_lr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta</span>,<span class="va">predictor</span>,<span class="va">response</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">predictor</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">-</span><span class="va">response</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">response</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loss_init</span> <span class="op">&lt;-</span> <span class="fu">loss_func_lr</span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta1</span>, predictor<span class="op">=</span><span class="va">X</span>,response<span class="op">=</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>Now,the package creates a function to get a estimate for coefficients. The function name would be <code>beta_ls</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta_ls</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">beta1</span>, <span class="va">loss_func_lr</span>, predictor<span class="op">=</span><span class="va">predictor</span>, response<span class="op">=</span><span class="va">response</span><span class="op">)</span><span class="op">$</span><span class="va">par</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu">loss_func_lr</span><span class="op">(</span><span class="va">par</span>,predictor<span class="op">=</span><span class="va">X</span>,response<span class="op">=</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>coefficient<span class="op">=</span><span class="va">par</span>, loss<span class="op">=</span><span class="va">loss</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">optim_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/beta_ls.html">beta_ls</a></span><span class="op">(</span>predictor<span class="op">=</span><span class="va">X</span>,response<span class="op">=</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">optim_beta</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## $coefficient</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                          [,1]</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">##                  0.6031355407</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">## age             -0.0697028208</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">## sex             -0.0257685364</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="do">## bmi             -0.1777873233</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="do">## children        -0.2536533153</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="do">## charges          0.0003379421</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="do">## regionnortheast  0.1897068715</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="do">## regionnorthwest -0.0841624978</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="do">## regionsoutheast  0.2547669186</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="do">## $loss</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 167.9594</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="bootstrap-confidence-interval">Bootstrap Confidence Interval<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-interval"></a>
</h4>
<p>The package includes a bootstrap function to estimate the variability and confidence intervals of the model coefficients, thereby enhancing the robustness of the analysis.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bootstrap_lr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">predictor_columns</span>, <span class="va">response_column</span>, <span class="va">num_bootstraps</span> <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Determine the number of predictors (including intercept)</span></span>
<span>  <span class="va">num_predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">predictor_columns</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  </span>
<span>  <span class="co"># Initialize a matrix to store the coefficients for each bootstrap sample</span></span>
<span>  <span class="va">coefficients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">num_bootstraps</span>, ncol <span class="op">=</span> <span class="va">num_predictors</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_bootstraps</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Resample the data</span></span>
<span>    <span class="va">sample_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">sample_indices</span>, <span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Fit the logistic regression model</span></span>
<span>    <span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">response_column</span>, <span class="st">"~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">predictor_columns</span>, collapse <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">fitted_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">sample_data</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Store the coefficients</span></span>
<span>    <span class="co"># Use `coef` function to extract coefficients and align with matrix dimensions</span></span>
<span>    <span class="va">model_coefficients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitted_model</span><span class="op">)</span></span>
<span>    <span class="va">coefficients</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">model_coefficients</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">model_coefficients</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">coefficients</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="drawing-a-fitted-plot-of-logistic-regression">Drawing a fitted plot of logistic regression<a class="anchor" aria-label="anchor" href="#drawing-a-fitted-plot-of-logistic-regression"></a>
</h4>
<p>The package uses a function which would draw the fitted logistic curve to the responses. The y-axis is the binary response y. The x-axis represents a sequence of values from the range of fitted value <span class="math inline"><em>ŷ</em> = <em>x</em><sup><em>T</em></sup><em>β</em></span>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_logistic_curve</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">beta_optim</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Calculate Xβ values</span></span>
<span>    <span class="va">X_beta_values</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_optim</span></span>
<span></span>
<span>    <span class="co"># Generate a sequence for plotting</span></span>
<span>    <span class="va">seq_X_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">X_beta_values</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">X_beta_values</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Calculate predicted probabilities using the logistic function</span></span>
<span>    <span class="va">predicted_probabilities</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">seq_X_beta</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Plot the curve</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">seq_X_beta</span>, <span class="va">predicted_probabilities</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"Xβ"</span>, ylab <span class="op">=</span> <span class="st">"Predicted Probability"</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Fitted Logistic Curve"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">X_beta_values</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="confusion-matrix">Confusion Matrix<a class="anchor" aria-label="anchor" href="#confusion-matrix"></a>
</h2>
<p>Confusion matrix is a specific table layout that allows visualization of the performance of an algorithm. Each column of the matrix represents the instances in an actual class while each row represents the instances in a predicted class.</p>
<p>The template for any binary confusion matrix uses the four kinds of results (true positives, false negatives, false positives, and true negatives) along with the positive and negative classifications. The four outcomes can be formulated in a confusion matrix, as follows:</p>
<table class="table">
<thead><tr class="header">
<th>Total</th>
<th>Actual Positive (P)</th>
<th>Actual Negative (N)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Predicted Positive (PP)</td>
<td>True Positive (TP)</td>
<td>False Positive (FP)</td>
</tr>
<tr class="even">
<td>Predicted Negative (PN)</td>
<td>False Negative (FN)</td>
<td>True Negative (TN)</td>
</tr>
</tbody>
</table>
<p>Based on the confusion matrix, we can compute the following metrics: <span class="math display">$$
\begin{align}
&amp;\text{Prevalence}=\frac{\text{P}}{\text{P}+\text{N}}\\
&amp;\text{Accuracy (ACC)}=\frac{\text{TP}+\text{TN}}{\text{P}+\text{N}}=\frac{\text{TP}+\text{TN}}{\text{TP}+\text{TN}+\text{FP}+\text{FN}}\\
&amp;\text{Sensitivity (TPR)}=\frac{\text{TP}}{\text{P}}=\frac{\text{TP}}{\text{TP}+\text{FN}}\\
&amp;\text{Specificity (TNR)}=\frac{\text{TN}}{\text{N}}=\frac{\text{TN}}{\text{TN}+\text{FP}}\\
&amp;\text{False Discovery Rate (FDR)}=\frac{\text{FP}}{\text{FP}+\text{TP}}\\
&amp;\text{Diagnostic Odds Ratio (DOR)}=\frac{\text{LR}_+}{\text{LR}_-}=\frac{\text{TPR}/\text{FPR}}{\text{FNR}/\text{TNR}}
\end{align}
$$</span></p>
<div class="section level4">
<h4 id="generating-the-confusion-matrix-of-logistic-regression-and-plotting">Generating the confusion matrix of logistic regression and plotting<a class="anchor" aria-label="anchor" href="#generating-the-confusion-matrix-of-logistic-regression-and-plotting"></a>
</h4>
<p><strong>Confusion Matrix:</strong> The package provides functionality to calculate a confusion matrix, which is crucial for evaluating the performance of the logistic regression model.</p>
<p><strong>Performance Metrics:</strong> It computes various performance metrics such as accuracy, sensitivity, specificity, false discovery rate, and diagnostic odds ratio from the confusion matrix.</p>
<p><strong>Probabilities and Cutoff Analysis:</strong> Additional functions compute predicted probabilities and perform analyses based on different cutoff values, allowing for a nuanced understanding of model performance.</p>
<p><strong>Visualization of Metrics:</strong> The package also includes functionality to plot these metrics across a range of cutoff values, offering a visual representation of model performance under different classification thresholds.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Calculate predicted probabilities</span></span>
<span><span class="va">pred_prob_ls</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">optim_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/beta_ls.html">beta_ls</a></span><span class="op">(</span><span class="va">predictor</span>,<span class="va">response</span><span class="op">)</span></span>
<span>  <span class="va">beta_optim</span> <span class="op">&lt;-</span> <span class="va">optim_beta</span><span class="op">$</span><span class="va">coefficient</span></span>
<span>  <span class="va">predicted_probabilities</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">predictor</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_optim</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">predicted_classes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">predicted_probabilities</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob<span class="op">=</span><span class="va">predicted_probabilities</span>,class<span class="op">=</span><span class="va">predicted_classes</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate the confusion martrix</span></span>
<span><span class="va">ls_confusion</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">predicted_probabilities</span> <span class="op">&lt;-</span> <span class="fu">pred_prob_ls</span><span class="op">(</span><span class="va">predictor</span>,<span class="va">response</span><span class="op">)</span><span class="op">$</span><span class="va">prob</span></span>
<span>  <span class="va">predicted_classes</span> <span class="op">&lt;-</span> <span class="fu">pred_prob_ls</span><span class="op">(</span><span class="va">predictor</span>,<span class="va">response</span><span class="op">)</span><span class="op">$</span><span class="va">class</span></span>
<span>  </span>
<span>  <span class="co"># Create Confusion Matrix</span></span>
<span>  <span class="va">conf_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span>Predicted <span class="op">=</span> <span class="va">predicted_classes</span>, Actual <span class="op">=</span> <span class="va">response</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate metrics</span></span>
<span>  <span class="va">prevalence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span></span>
<span>  <span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">)</span></span>
<span>  <span class="va">sensitivity</span> <span class="op">&lt;-</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">specificity</span> <span class="op">&lt;-</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">false_discovery_rate</span> <span class="op">&lt;-</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">diagnostic_odds_ratio</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Output</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ConfusionMatrix <span class="op">=</span> <span class="va">conf_matrix</span>,</span>
<span>       Prevalence <span class="op">=</span> <span class="va">prevalence</span>,</span>
<span>       Accuracy <span class="op">=</span> <span class="va">accuracy</span>,</span>
<span>       Sensitivity <span class="op">=</span> <span class="va">sensitivity</span>,</span>
<span>       Specificity <span class="op">=</span> <span class="va">specificity</span>,</span>
<span>       FalseDiscoveryRate <span class="op">=</span> <span class="va">false_discovery_rate</span>,</span>
<span>       DiagnosticOddsRatio <span class="op">=</span> <span class="va">diagnostic_odds_ratio</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compute the confusion matrix of logistic regression with the cut-off value 0.5</span></span>
<span><span class="fu">ls_confusion</span><span class="op">(</span>predictor <span class="op">=</span> <span class="va">X</span>, response <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## $ConfusionMatrix</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">##          Actual</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Predicted    0    1</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">##         0 1025   40</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="do">##         1   39  234</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $Prevalence</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2047833</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="do">## $Accuracy</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9409567</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="do">## $Sensitivity</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8540146</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="do">## $Specificity</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9633459</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="do">## $FalseDiscoveryRate</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1428571</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="do">## $DiagnosticOddsRatio</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 153.75</span></span></code></pre></div>
<div class="section level5">
<h5 id="plots-of-any-of-metrics-based-on-different-cut-off-values-from-01-to-09-with-steps-of-01">Plots of any of metrics based on different cut-off values from 0.1 to 0.9 with steps of 0.1<a class="anchor" aria-label="anchor" href="#plots-of-any-of-metrics-based-on-different-cut-off-values-from-01-to-09-with-steps-of-01"></a>
</h5>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_prob_ls2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span>, <span class="va">cutoff_value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">optim_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/beta_ls.html">beta_ls</a></span><span class="op">(</span><span class="va">predictor</span>,<span class="va">response</span><span class="op">)</span></span>
<span>  <span class="va">beta_optim</span> <span class="op">&lt;-</span> <span class="va">optim_beta</span><span class="op">$</span><span class="va">coefficient</span></span>
<span>  <span class="va">predicted_probabilities</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">predictor</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_optim</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">predicted_classes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">predicted_probabilities</span> <span class="op">&gt;</span> <span class="va">cutoff_value</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob<span class="op">=</span><span class="va">predicted_probabilities</span>,class<span class="op">=</span><span class="va">predicted_classes</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Function to calculate metrics for a given cut-off value</span></span>
<span><span class="va">calculate_metrics2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span>, <span class="va">cutoff_value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">predicted_probabilities</span> <span class="op">&lt;-</span> <span class="fu">pred_prob_ls2</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span>, <span class="va">cutoff_value</span><span class="op">)</span><span class="op">$</span><span class="va">prob</span></span>
<span>  <span class="va">predicted_classes</span> <span class="op">&lt;-</span> <span class="fu">pred_prob_ls2</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span>, <span class="va">cutoff_value</span><span class="op">)</span><span class="op">$</span><span class="va">class</span></span>
<span>  </span>
<span>  <span class="va">conf_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span>Predicted <span class="op">=</span> <span class="va">predicted_classes</span>, Actual <span class="op">=</span> <span class="va">response</span><span class="op">)</span></span>
<span>        </span>
<span>  <span class="co"># Calculate various metrics</span></span>
<span>  <span class="va">prevalence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">)</span></span>
<span>  <span class="va">sensitivity</span> <span class="op">&lt;-</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">specificity</span> <span class="op">&lt;-</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">false_discovery_rate</span> <span class="op">&lt;-</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">diagnostic_odds_ratio</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">conf_matrix</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">conf_matrix</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Output</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>conf_matrix<span class="op">=</span><span class="va">conf_matrix</span>,</span>
<span>                 prevalence<span class="op">=</span><span class="va">prevalence</span>,</span>
<span>                 accuracy<span class="op">=</span><span class="va">accuracy</span>,</span>
<span>                 sensitivity<span class="op">=</span><span class="va">sensitivity</span>,</span>
<span>                 specificity<span class="op">=</span><span class="va">specificity</span>,</span>
<span>                 false_discovery_rate<span class="op">=</span><span class="va">false_discovery_rate</span>,</span>
<span>                 diagnostic_odds_ratio<span class="op">=</span><span class="va">diagnostic_odds_ratio</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">compute_and_plot_logistic_metrics</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span>, <span class="va">typeofmetric</span>, <span class="va">plot_metric</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">cutoff_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span>  <span class="va">metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cutoff_values</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prevalence"</span>, <span class="st">"Accuracy"</span>, <span class="st">"Sensitivity"</span>, <span class="st">"Specificity"</span>, <span class="st">"False Discovery Rate"</span>, <span class="st">"Diagnostic Odds Ratio"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">typeofmetric</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Invalid metric name. Choose from Prevalence, Accuracy, Sensitivity, Specificity, False Discovery Rate, Diagnostic Odds Ratio."</span><span class="op">)</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cutoff_values</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">typeofmetric</span><span class="op">==</span><span class="va">name</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span></span>
<span>      <span class="va">metric</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">calculate_metrics2</span><span class="op">(</span><span class="va">predictor</span>, <span class="va">response</span>, cutoff_value<span class="op">=</span><span class="va">cutoff_values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="va">number</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cutoff_values</span>, <span class="va">metric</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>         xlab<span class="op">=</span><span class="st">"Cut-off Value"</span>, ylab<span class="op">=</span><span class="st">""</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Plot of"</span>,<span class="va">typeofmetric</span>,<span class="st">"over Different Cut-off Values"</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prevalence"</span>, <span class="st">"Accuracy"</span>, <span class="st">"Sensitivity"</span>, <span class="st">"Specificity"</span>, <span class="st">"False Discovery Rate"</span>, <span class="st">"Diagnostic Odds Ratio"</span><span class="op">)</span></span>
<span>  <span class="fu">compute_and_plot_logistic_metrics</span><span class="op">(</span>predictor<span class="op">=</span><span class="va">X</span>, response<span class="op">=</span><span class="va">y</span>, typeofmetric<span class="op">=</span><span class="va">name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, plot_metric <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-13-1.png"><!-- --><img src="README_files/figure-gfm/unnamed-chunk-13-2.png"><!-- --><img src="README_files/figure-gfm/unnamed-chunk-13-3.png"><!-- --><img src="README_files/figure-gfm/unnamed-chunk-13-4.png"><!-- --><img src="README_files/figure-gfm/unnamed-chunk-13-5.png"><!-- --><img src="README_files/figure-gfm/unnamed-chunk-13-6.png"><!-- --></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GNU General Public License</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing lrpackage</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sk Nafiz Rahaman <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Sk Nafiz Rahaman.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
